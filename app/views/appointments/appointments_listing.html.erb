<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<script type="text/javascript">
	
	$(document).ready(function() {
		function disablePrintButton() {
			checkBoxes = $("#appointment_form :checkbox[checked=true]");
			$("#appointment_form :input[type=submit]").attr('disabled', (checkBoxes.length == 0));
		}
		
		$("#appointment_form :checkbox").click(function() { disablePrintButton(); });
		
		disablePrintButton();
	});
	
</script>
<div id="appointments_listing">
  <h2>Appointments</h2>
  <div class="search">
    <% form_tag search_path do %>
      <%= label_tag "Last Name:" %>
      <%= text_field_tag :last_name %>
      <%= label_tag "County:" %>
      <%= text_field_tag :county %>
      <%= label_tag "Zip Code" %>
      <%= text_field_tag :postal_code, nil, :size => 10, :max_length => 10 %>
      <div class="booleans">
        <%= label_tag "Cat" %>
        <%= radio_button_tag :cat_or_dog, :cat %>
        <%= label_tag "Dog" %>
        <%= radio_button_tag :cat_or_dog, :dog %>
        <%= label_tag "Vaccinated?" %>
        <%= check_box_tag :vaccinated %>
      </div>
      <%= submit_tag "Search", :class => "button"  %>
    <% end %>
  </div>
  <% if @appointments.blank? %>
    <h2>There are no appointments.</h2>
  <% else %>  
  
      <%= will_paginate @appointments %>
      
      <%- form_tag(appointment_path(0), :method => 'get', :id => 'appointment_form') do -%> 
      <table>
        <thead>
          <tr>
            <th>&nbsp;</th>
            <th>ID</th>
            <th>Name</th>
            <th>Phone</th>
            <th>Pet</th>
            <th>Vaccinated?</th>
            <th>Pregnant?</th>
            <th>Surgery?</th>
            <th>Health?</th>
            <th>Meds?</th>
            <th>&nbsp;</th>
          </tr>
        </thead>
        <tbody>

            <tr class="last">
              <td colspan="2"><%= submit_tag "Print Selected" %></td>
              <td colspan="8">&nbsp;</td>
            </tr>
            <% @appointments.each do |appointment| -%>
              <tr>
                <td><%= check_box_tag "ids[]", appointment.id %></td>
                <td><%= appointment.id %></td>
                <td><%= appointment.client_name_last_comma_first %> </td>
                <td>
                  <%= appointment.phone %><br />
                  <%= appointment.alternate_phone %>
                </td>
                <td><%= appointment.cat_or_dog %>/<%= appointment.gender %>: <%= appointment.pet_name %> </td>
                <td><%= appointment.vaccinated? ? "Yes" : content_tag(:strong, "No") %> </td>
                <td><%= appointment.pregnant?   ? content_tag(:strong, "Yes") : "No" %> </td>
                <td><%= link_to_if(appointment.surgeries, "Yes", appointment, :anchor => 'surgeries',
                                   :title => h(appointment.surgeries_explanation)) {|_| "No" } %> </td>
                <td><%= link_to_if(appointment.health_concerns, "Yes", appointment, :anchor => 'health_concerns',
                                   :title => h(appointment.health_concerns_explanation)) {|_| "No" } %> </td>
                <td><%= link_to_if(appointment.medications, "Yes", appointment, :anchor => 'medications',
                                   :title => h(appointment.medications_explanation)) {|_| "No" } %> </td>
                <td><%= link_to 'Show', appointment %> </td>
              </tr>
            <% end -%>
            <tr class="last">
              <td colspan="2"><%= submit_tag "Print Selected" %></td>
              <td colspan="8">&nbsp;</td>
            </tr>
        </tbody>
      </table>
      <%- end -%>
      <%= will_paginate @appointments %>
  <% end %>
</div>
